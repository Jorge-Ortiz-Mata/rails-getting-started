<%= turbo_frame_tag 'profile' %>
<%= render 'shared/page_header', title: 'Mi perfil' %>

<div class="flex flex-col gap-5 h-full overflow-auto bg-red-100 py-5 px-2 sm:px-5">
  <div class="flex flex-col items-start w-full px-2 sm:px-5 py-5 shadow rounded border bg-white gap-10">
    <%= form_with(model: @update_account, url: update_user_path(current_user.uid), method: :patch, class: 'flex flex-col gap-5 w-full') do |f| %>
      <div class="flex flex-col w-full items-start">
        <%= f.label :email, 'Correo electrónico:', class: 'font-bold required' %>
        <%= f.email_field :email, class: "input-style #{error_border(@update_account.errors.include?(:email))}" %>
        <% if @update_account.errors.include?(:email) %>
          <%= render 'shared/error_input', { object: @update_account, attribute: :email } %>
        <% end %>
      </div>

      <div class="flex flex-col w-full items-start">
        <%= f.label :password, 'Nueva contraseña:', class: 'font-bold required' %>
        <%= f.password_field :password, class: "input-style #{error_border(@update_account.errors.include?(:password))}" %>
        <span class="text-sm text-sidebarTextColor font-medium italic">La contraseña debe tener al menos 8 caracteres</span>
        <% if @update_account.errors.include?(:password) %>
          <%= render 'shared/error_input', { object: @update_account, attribute: :password } %>
        <% end %>
      </div>

      <div class="flex flex-col w-full items-start">
        <%= f.label :password_confirmation, 'Confirmación de nueva contraseña:', class: 'font-bold required' %>
        <%= f.password_field :password_confirmation, class: "input-style #{error_border(@update_account.errors.include?(:password_confirmation))}" %>
        <% if @update_account.errors.include?(:password_confirmation) %>
          <%= render 'shared/error_input', { object: @update_account, attribute: :password_confirmation } %>
        <% end %>
      </div>

      <div class="flex flex-col w-full items-start">
        <%= f.label :old_password, 'Porfavor, ingresa tu contraseña anterior para guardar los cambios', class: 'font-bold required' %>
        <%= f.password_field :old_password, class: "input-style #{error_border(@update_account.errors.include?(:old_password))}" %>
        <% if @update_account.errors.include?(:old_password) %>
          <%= render 'shared/error_input', { object: @update_account, attribute: :old_password } %>
        <% end %>
      </div>

      <div class="flex items-center justify-end gap-5">
        <div class="flex items-center text-sm font-semibold">
          <%= f.submit 'Actualizar cuenta', class: "rounded py-2 px-4 bg-green-500 text-white font-semibold cursor-pointer" %>
        </div>

        <%= link_to user_path(current_user.uid), class: "flex text-sm font-semibold rounded bg-danger px-4 py-2 text-white items-center gap-1" do %>
          <span>Regresar</span>
        <% end %>
      </div>
    <% end %>

    <div class="border border-red-500 rounded shadow flex flex-col gap-5 w-full px-2 sm:px-5 py-5">
      <p class="font-semibold text-lg text-red-600">Zona de riesgo:</p>
      <p class="text-red-500">Una vez que canceles tu cuenta, toda tu información será eliminada de nuestros servidores</p>
      <%= button_to destroy_user_path, method: :delete, id: 'cancel_account', form: { data: { turbo_confirm: '¿Estás seguro de inhabilitar este registro?' } }, class: 'btn-danger text-xs' do %>
        Cancelar cuenta
      <% end %>
    </div>
  </div>
</div>
